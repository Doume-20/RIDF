!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(global,(()=>(()=>{var e={366:(e,t,r)=>{"use strict";const n=r(81),o=r(322),i=r(225);function s(e,t,r){const s=o(e,t,r),c=n.spawn(s.command,s.args,s.options);return i.hookChildProcess(c,s),c}e.exports=s,e.exports.spawn=s,e.exports.sync=function(e,t,r){const s=o(e,t,r),c=n.spawnSync(s.command,s.args,s.options);return c.error=c.error||i.verifyENOENTSync(c.status,s),c},e.exports._parse=o,e.exports._enoent=i},225:e=>{"use strict";const t="win32"===process.platform;function r(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function n(e,n){return t&&1===e&&!n.file?r(n.original,"spawn"):null}e.exports={hookChildProcess:function(e,r){if(!t)return;const o=e.emit;e.emit=function(t,i){if("exit"===t){const t=n(i,r);if(t)return o.call(e,"error",t)}return o.apply(e,arguments)}},verifyENOENT:n,verifyENOENTSync:function(e,n){return t&&1===e&&!n.file?r(n.original,"spawnSync"):null},notFoundError:r}},322:(e,t,r)=>{"use strict";const n=r(17),o=r(728),i=r(649),s=r(74),c="win32"===process.platform,a=/\.(?:com|exe)$/i,u=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;e.exports=function(e,t,r){t&&!Array.isArray(t)&&(r=t,t=null);const l={command:e,args:t=t?t.slice(0):[],options:r=Object.assign({},r),file:void 0,original:{command:e,args:t}};return r.shell?l:function(e){if(!c)return e;const t=function(e){e.file=o(e);const t=e.file&&s(e.file);return t?(e.args.unshift(e.file),e.command=t,o(e)):e.file}(e),r=!a.test(t);if(e.options.forceShell||r){const r=u.test(t);e.command=n.normalize(e.command),e.command=i.command(e.command),e.args=e.args.map((e=>i.argument(e,r)));const o=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${o}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}(l)}},649:e=>{"use strict";const t=/([()\][%!^"`<>&|;, *?])/g;e.exports.command=function(e){return e.replace(t,"^$1")},e.exports.argument=function(e,r){return e=(e=`"${e=(e=(e=`${e}`).replace(/(\\*)"/g,'$1$1\\"')).replace(/(\\*)$/,"$1$1")}"`).replace(t,"^$1"),r&&(e=e.replace(t,"^$1")),e}},74:(e,t,r)=>{"use strict";const n=r(147),o=r(279);e.exports=function(e){const t=Buffer.alloc(150);let r;try{r=n.openSync(e,"r"),n.readSync(r,t,0,150,0),n.closeSync(r)}catch(e){}return o(t.toString())}},728:(e,t,r)=>{"use strict";const n=r(17),o=r(644),i=r(384);function s(e,t){const r=e.options.env||process.env,s=process.cwd(),c=null!=e.options.cwd,a=c&&void 0!==process.chdir&&!process.chdir.disabled;if(a)try{process.chdir(e.options.cwd)}catch(e){}let u;try{u=o.sync(e.command,{path:r[i({env:r})],pathExt:t?n.delimiter:void 0})}catch(e){}finally{a&&process.chdir(s)}return u&&(u=n.resolve(c?e.options.cwd:"",u)),u}e.exports=function(e){return s(e)||s(e,!0)}},644:(e,t,r)=>{const n="win32"===process.platform||"cygwin"===process.env.OSTYPE||"msys"===process.env.OSTYPE,o=r(17),i=n?";":":",s=r(799),c=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),a=(e,t)=>{const r=t.colon||i,o=e.match(/\//)||n&&e.match(/\\/)?[""]:[...n?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(r)],s=n?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",c=n?s.split(r):[""];return n&&-1!==e.indexOf(".")&&""!==c[0]&&c.unshift(""),{pathEnv:o,pathExt:c,pathExtExe:s}},u=(e,t,r)=>{"function"==typeof t&&(r=t,t={}),t||(t={});const{pathEnv:n,pathExt:i,pathExtExe:u}=a(e,t),l=[],d=r=>new Promise(((i,s)=>{if(r===n.length)return t.all&&l.length?i(l):s(c(e));const a=n[r],u=/^".*"$/.test(a)?a.slice(1,-1):a,d=o.join(u,e),f=!u&&/^\.[\\\/]/.test(e)?e.slice(0,2)+d:d;i(p(f,r,0))})),p=(e,r,n)=>new Promise(((o,c)=>{if(n===i.length)return o(d(r+1));const a=i[n];s(e+a,{pathExt:u},((i,s)=>{if(!i&&s){if(!t.all)return o(e+a);l.push(e+a)}return o(p(e,r,n+1))}))}));return r?d(0).then((e=>r(null,e)),r):d(0)};e.exports=u,u.sync=(e,t)=>{t=t||{};const{pathEnv:r,pathExt:n,pathExtExe:i}=a(e,t),u=[];for(let c=0;c<r.length;c++){const a=r[c],l=/^".*"$/.test(a)?a.slice(1,-1):a,d=o.join(l,e),p=!l&&/^\.[\\\/]/.test(e)?e.slice(0,2)+d:d;for(let e=0;e<n.length;e++){const r=p+n[e];try{if(s.sync(r,{pathExt:i})){if(!t.all)return r;u.push(r)}}catch(e){}}}if(t.all&&u.length)return u;if(t.nothrow)return null;throw c(e)}},179:(e,t,r)=>{var n=r(875),o=function(){},i=function(e,t,r){if("function"==typeof t)return i(e,null,t);t||(t={}),r=n(r||o);var s=e._writableState,c=e._readableState,a=t.readable||!1!==t.readable&&e.readable,u=t.writable||!1!==t.writable&&e.writable,l=!1,d=function(){e.writable||p()},p=function(){u=!1,a||r.call(e)},f=function(){a=!1,u||r.call(e)},m=function(t){r.call(e,t?new Error("exited with error code: "+t):null)},g=function(t){r.call(e,t)},h=function(){process.nextTick(x)},x=function(){if(!l)return(!a||c&&c.ended&&!c.destroyed)&&(!u||s&&s.ended&&!s.destroyed)?void 0:r.call(e,new Error("premature close"))},y=function(){e.req.on("finish",p)};return function(e){return e.setHeader&&"function"==typeof e.abort}(e)?(e.on("complete",p),e.on("abort",h),e.req?y():e.on("request",y)):u&&!s&&(e.on("end",d),e.on("close",d)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",m),e.on("end",f),e.on("finish",p),!1!==t.error&&e.on("error",g),e.on("close",h),function(){l=!0,e.removeListener("complete",p),e.removeListener("abort",h),e.removeListener("request",y),e.req&&e.req.removeListener("finish",p),e.removeListener("end",d),e.removeListener("close",d),e.removeListener("finish",p),e.removeListener("exit",m),e.removeListener("end",f),e.removeListener("error",g),e.removeListener("close",h)}};e.exports=i},723:(e,t,r)=>{"use strict";const n=r(17),o=r(81),i=r(366),s=r(709),c=r(548),a=r(900),u=r(782),l=r(933),{spawnedKill:d,spawnedCancel:p,setupTimeout:f,setExitHandler:m}=r(270),{handleInput:g,getSpawnedResult:h,makeAllStream:x,validateInputSync:y}=r(3),{mergePromise:w,getSpawnedPromise:v}=r(953),{joinCommand:b,parseCommand:E}=r(82),S=(e,t,r={})=>{const o=i._parse(e,t,r);return e=o.command,t=o.args,(r={maxBuffer:1e8,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:(r=o.options).cwd||process.cwd(),encoding:"utf8",reject:!0,cleanup:!0,...r,windowsHide:!0}).env=(({env:e,extendEnv:t,preferLocal:r,localDir:n})=>{const o=t?{...process.env,...e}:e;return r?c.env({env:o,cwd:n}):o})(r),r.stdio=l(r),"win32"===process.platform&&"cmd"===n.basename(e,".exe")&&t.unshift("/q"),{file:e,args:t,options:r,parsed:o}},C=(e,t,r)=>"string"==typeof t||Buffer.isBuffer(t)?e.stripFinalNewline?s(t):t:void 0===r?void 0:"",T=(e,t,r)=>{const n=S(e,t,r),s=b(e,t);let c;try{c=o.spawn(n.file,n.args,n.options)}catch(e){const t=new o.ChildProcess,r=Promise.reject(u({error:e,stdout:"",stderr:"",all:"",command:s,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return w(t,r)}const l=v(c),y=f(c,n.options,l),E=m(c,n.options,y),T={isCanceled:!1};c.kill=d.bind(null,c.kill.bind(c)),c.cancel=p.bind(null,c,T);const P=a((async()=>{const[{error:e,code:t,signal:r,timedOut:o},i,a,l]=await h(c,n.options,E),d=C(n.options,i),p=C(n.options,a),f=C(n.options,l);if(e||0!==t||null!==r){const i=u({error:e,code:t,signal:r,stdout:d,stderr:p,all:f,command:s,parsed:n,timedOut:o,isCanceled:T.isCanceled,killed:c.killed});if(!n.options.reject)return i;throw i}return{command:s,exitCode:0,exitCodeName:"SUCCESS",stdout:d,stderr:p,all:f,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}}));return i._enoent.hookChildProcess(c,n.parsed),g(c,n.options.input),c.all=x(c),w(c,P)};e.exports=T,e.exports.sync=(e,t,r)=>{const n=S(e,t,r),i=b(e,t);let s;y(n.options);try{s=o.spawnSync(n.file,n.args,n.options)}catch(e){throw u({error:e,stdout:"",stderr:"",all:"",command:i,parsed:n,timedOut:!1,isCanceled:!1,killed:!1})}if(s.stdout=C(n.options,s.stdout,s.error),s.stderr=C(n.options,s.stderr,s.error),s.error||0!==s.status||null!==s.signal){const e=u({...s,code:s.status,command:i,parsed:n,timedOut:s.error&&"ETIMEDOUT"===s.error.code,isCanceled:!1,killed:null!==s.signal});if(!n.options.reject)return e;throw e}return{command:i,exitCode:0,exitCodeName:"SUCCESS",stdout:s.stdout,stderr:s.stderr,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}},e.exports.command=(e,t)=>{const[r,...n]=E(e);return T(r,n,t)},e.exports.commandSync=(e,t)=>{const[r,...n]=E(e);return T.sync(r,n,t)},e.exports.node=(e,t,r={})=>{t&&!Array.isArray(t)&&"object"==typeof t&&(r=t,t=[]);const n=l.node(r),{nodePath:o=process.execPath,nodeOptions:i=process.execArgv}=r;return T(o,[...i,e,...Array.isArray(t)?t:[]],{...r,stdin:void 0,stdout:void 0,stderr:void 0,stdio:n,shell:!1})}},82:e=>{"use strict";const t=/ +/g,r=(e,t,r)=>{if(0===r)return[t];const n=e[e.length-1];return n.endsWith("\\")?[...e.slice(0,-1),`${n.slice(0,-1)} ${t}`]:[...e,t]};e.exports={joinCommand:(e,t=[])=>Array.isArray(t)?[e,...t].join(" "):e,parseCommand:e=>e.trim().split(t).reduce(r,[])}},782:(e,t,r)=>{"use strict";const n=r(37),o=r(837);e.exports=({stdout:e,stderr:t,all:r,error:i,signal:s,code:c,command:a,timedOut:u,isCanceled:l,killed:d,parsed:{options:{timeout:p}}})=>{const[f,m]=((e,t)=>e&&e.code?[e.code,n.constants.errno[e.code]]:Number.isInteger(t)?[o.getSystemErrorName(-t),t]:[])(i,c),g=(({timedOut:e,timeout:t,signal:r,exitCodeName:n,exitCode:o,isCanceled:i})=>e?`timed out after ${t} milliseconds`:i?"was canceled":r?`was killed with ${r}`:void 0!==o?`failed with exit code ${o} (${n})`:"failed")({timedOut:u,timeout:p,signal:s,exitCodeName:f,exitCode:m,isCanceled:l}),h=`Command ${g}: ${a}`;return i instanceof Error?(i.originalMessage=i.message,i.message=`${h}\n${i.message}`):i=new Error(h),i.command=a,delete i.code,i.exitCode=m,i.exitCodeName=f,i.stdout=e,i.stderr=t,void 0!==r&&(i.all=r),"bufferedData"in i&&delete i.bufferedData,i.failed=!0,i.timedOut=Boolean(u),i.isCanceled=l,i.killed=d&&!u,i.signal=s||void 0,i}},270:(e,t,r)=>{"use strict";const n=r(37),o=r(164),i=r(664),s=(e,{forceKillAfterTimeout:t},r)=>c(e)&&!1!==t&&r,c=e=>e===n.constants.signals.SIGTERM||"string"==typeof e&&"SIGTERM"===e.toUpperCase(),a=({forceKillAfterTimeout:e=!0})=>{if(!0===e)return 5e3;if(!Number.isInteger(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e};e.exports={spawnedKill:(e,t="SIGTERM",r={})=>{const n=e(t);return((e,t,r,n)=>{if(!s(t,r,n))return;const o=a(r);setTimeout((()=>{e("SIGKILL")}),o).unref()})(e,t,r,n),n},spawnedCancel:(e,t)=>{e.kill()&&(t.isCanceled=!0)},setupTimeout:(e,{timeout:t,killSignal:r="SIGTERM"},n)=>{if(0===t||void 0===t)return n;if(!Number.isInteger(t)||t<0)throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${t}\` (${typeof t})`);let o;const s=new Promise(((n,i)=>{o=setTimeout((()=>{((e,t,r)=>{e.kill(t),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))})(e,r,i)}),t)})),c=i(n,(()=>{clearTimeout(o)}));return Promise.race([s,c])},setExitHandler:(e,{cleanup:t,detached:r},n)=>{if(!t||r)return n;const s=o((()=>{e.kill()}));return i(n,s)}}},953:e=>{"use strict";const t=(e,t,r)=>{const n="function"==typeof t?(...e)=>t()[r](...e):t[r].bind(t);Object.defineProperty(e,r,{value:n,writable:!0,enumerable:!1,configurable:!0})};e.exports={mergePromise:(e,r)=>(t(e,r,"then"),t(e,r,"catch"),Promise.prototype.finally&&t(e,r,"finally"),e),getSpawnedPromise:e=>new Promise(((t,r)=>{e.on("exit",((e,r)=>{t({code:e,signal:r})})),e.on("error",(e=>{r(e)})),e.stdin&&e.stdin.on("error",(e=>{r(e)}))}))}},933:e=>{"use strict";const t=["stdin","stdout","stderr"],r=e=>{if(!e)return;const{stdio:r}=e;if(void 0===r)return t.map((t=>e[t]));if((e=>t.some((t=>void 0!==e[t])))(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${t.map((e=>`\`${e}\``)).join(", ")}`);if("string"==typeof r)return r;if(!Array.isArray(r))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof r}\``);const n=Math.max(r.length,t.length);return Array.from({length:n},((e,t)=>r[t]))};e.exports=r,e.exports.node=e=>{const t=r(e);return"ipc"===t?"ipc":void 0===t||"string"==typeof t?[t,t,t,"ipc"]:t.includes("ipc")?t:[...t,"ipc"]}},3:(e,t,r)=>{"use strict";const n=r(206),o=r(954),i=r(638),s=async(e,t)=>{if(e){e.destroy();try{return await t}catch(e){return e.bufferedData}}},c=(e,{encoding:t,buffer:r,maxBuffer:n})=>{if(e)return r?t?o(e,{encoding:t,maxBuffer:n}):o.buffer(e,{maxBuffer:n}):new Promise(((t,r)=>{e.once("end",t).once("error",r)}))};e.exports={handleInput:(e,t)=>{void 0!==t&&void 0!==e.stdin&&(n(t)?t.pipe(e.stdin):e.stdin.end(t))},makeAllStream:e=>{if(!e.stdout&&!e.stderr)return;const t=i();return e.stdout&&t.add(e.stdout),e.stderr&&t.add(e.stderr),t},getSpawnedResult:async({stdout:e,stderr:t,all:r},{encoding:n,buffer:o,maxBuffer:i},a)=>{const u=c(e,{encoding:n,buffer:o,maxBuffer:i}),l=c(t,{encoding:n,buffer:o,maxBuffer:i}),d=c(r,{encoding:n,buffer:o,maxBuffer:2*i});try{return await Promise.all([a,u,l,d])}catch(n){return Promise.all([{error:n,code:n.code,signal:n.signal,timedOut:n.timedOut},s(e,u),s(t,l),s(r,d)])}},validateInputSync:({input:e})=>{if(n(e))throw new TypeError("The `input` option cannot be a stream in sync mode")}}},445:(e,t,r)=>{"use strict";const{PassThrough:n}=r(781);e.exports=e=>{e={...e};const{array:t}=e;let{encoding:r}=e;const o="buffer"===r;let i=!1;t?i=!(r||o):r=r||"utf8",o&&(r=null);const s=new n({objectMode:i});r&&s.setEncoding(r);let c=0;const a=[];return s.on("data",(e=>{a.push(e),i?c=a.length:c+=e.length})),s.getBufferedValue=()=>t?a:o?Buffer.concat(a,c):a.join(""),s.getBufferedLength=()=>c,s}},954:(e,t,r)=>{"use strict";const{constants:n}=r(300),o=r(820),i=r(445);class s extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}}async function c(e,t){if(!e)return Promise.reject(new Error("Expected a stream"));t={maxBuffer:1/0,...t};const{maxBuffer:r}=t;let c;return await new Promise(((a,u)=>{const l=e=>{e&&c.getBufferedLength()<=n.MAX_LENGTH&&(e.bufferedData=c.getBufferedValue()),u(e)};c=o(e,i(t),(e=>{e?l(e):a()})),c.on("data",(()=>{c.getBufferedLength()>r&&l(new s)}))})),c.getBufferedValue()}e.exports=c,e.exports.default=c,e.exports.buffer=(e,t)=>c(e,{...t,encoding:"buffer"}),e.exports.array=(e,t)=>c(e,{...t,array:!0}),e.exports.MaxBufferError=s},548:(e,t,r)=>{"use strict";const n=r(17),o=r(384),i=e=>{let t;e={cwd:process.cwd(),path:process.env[o()],...e};let r=n.resolve(e.cwd);const i=[];for(;t!==r;)i.push(n.join(r,"node_modules/.bin")),t=r,r=n.resolve(r,"..");return i.push(n.dirname(process.execPath)),i.concat(e.path).join(n.delimiter)};e.exports=i,e.exports.default=i,e.exports.env=t=>{const r={...(t={env:process.env,...t}).env},n=o({env:r});return t.path=r[n],r[n]=e.exports(t),r}},664:e=>{"use strict";e.exports=async(e,t=(()=>{}))=>{let r;try{r=await e}catch(e){throw await t(),e}return await t(),r}},206:e=>{"use strict";const t=e=>null!==e&&"object"==typeof e&&"function"==typeof e.pipe;t.writable=e=>t(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState,t.readable=e=>t(e)&&!1!==e.readable&&"function"==typeof e._read&&"object"==typeof e._readableState,t.duplex=e=>t.writable(e)&&t.readable(e),t.transform=e=>t.duplex(e)&&"function"==typeof e._transform,e.exports=t},799:(e,t,r)=>{var n;function o(e,t,r){if("function"==typeof t&&(r=t,t={}),!r){if("function"!=typeof Promise)throw new TypeError("callback not provided");return new Promise((function(r,n){o(e,t||{},(function(e,t){e?n(e):r(t)}))}))}n(e,t||{},(function(e,n){e&&("EACCES"===e.code||t&&t.ignoreErrors)&&(e=null,n=!1),r(e,n)}))}r(147),n="win32"===process.platform||global.TESTING_WINDOWS?r(553):r(668),e.exports=o,o.sync=function(e,t){try{return n.sync(e,t||{})}catch(e){if(t&&t.ignoreErrors||"EACCES"===e.code)return!1;throw e}}},668:(e,t,r)=>{e.exports=o,o.sync=function(e,t){return i(n.statSync(e),t)};var n=r(147);function o(e,t,r){n.stat(e,(function(e,n){r(e,!e&&i(n,t))}))}function i(e,t){return e.isFile()&&function(e,t){var r=e.mode,n=e.uid,o=e.gid,i=void 0!==t.uid?t.uid:process.getuid&&process.getuid(),s=void 0!==t.gid?t.gid:process.getgid&&process.getgid(),c=parseInt("100",8),a=parseInt("010",8);return r&parseInt("001",8)||r&a&&o===s||r&c&&n===i||r&(c|a)&&0===i}(e,t)}},553:(e,t,r)=>{e.exports=i,i.sync=function(e,t){return o(n.statSync(e),e,t)};var n=r(147);function o(e,t,r){return!(!e.isSymbolicLink()&&!e.isFile())&&function(e,t){var r=void 0!==t.pathExt?t.pathExt:process.env.PATHEXT;if(!r)return!0;if(-1!==(r=r.split(";")).indexOf(""))return!0;for(var n=0;n<r.length;n++){var o=r[n].toLowerCase();if(o&&e.substr(-o.length).toLowerCase()===o)return!0}return!1}(t,r)}function i(e,t,r){n.stat(e,(function(n,i){r(n,!n&&o(i,e,t))}))}},638:(e,t,r)=>{"use strict";const{PassThrough:n}=r(781);e.exports=function(){var e=[],t=new n({objectMode:!0});return t.setMaxListeners(0),t.add=r,t.isEmpty=o,t.on("unpipe",i),Array.prototype.slice.call(arguments).forEach(r),t;function r(n){return Array.isArray(n)?(n.forEach(r),this):(e.push(n),n.once("end",i.bind(null,n)),n.once("error",t.emit.bind(t,"error")),n.pipe(t,{end:!1}),this)}function o(){return 0==e.length}function i(r){!(e=e.filter((function(e){return e!==r}))).length&&t.readable&&t.end()}}},927:e=>{"use strict";const t=(e,t)=>{for(const r of Reflect.ownKeys(t))Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));return e};e.exports=t,e.exports.default=t},875:(e,t,r)=>{var n=r(602);function o(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function i(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}e.exports=n(o),e.exports.strict=n(i),o.proto=o((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return o(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return i(this)},configurable:!0})}))},900:(e,t,r)=>{"use strict";const n=r(927),o=new WeakMap,i=(e,t={})=>{if("function"!=typeof e)throw new TypeError("Expected a function");let r,i=0;const s=e.displayName||e.name||"<anonymous>",c=function(...n){if(o.set(c,++i),1===i)r=e.apply(this,n),e=null;else if(!0===t.throw)throw new Error(`Function \`${s}\` can only be called once`);return r};return n(c,e),o.set(c,i),c};e.exports=i,e.exports.default=i,e.exports.callCount=e=>{if(!o.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return o.get(e)}},384:e=>{"use strict";const t=(e={})=>{const t=e.env||process.env;return"win32"!==(e.platform||process.platform)?"PATH":Object.keys(t).reverse().find((e=>"PATH"===e.toUpperCase()))||"Path"};e.exports=t,e.exports.default=t},820:(e,t,r)=>{var n=r(875),o=r(179),i=r(147),s=function(){},c=/^v?\.0/.test(process.version),a=function(e){return"function"==typeof e},u=function(e,t,r,u){u=n(u);var l=!1;e.on("close",(function(){l=!0})),o(e,{readable:t,writable:r},(function(e){if(e)return u(e);l=!0,u()}));var d=!1;return function(t){if(!l&&!d)return d=!0,function(e){return!!c&&!!i&&(e instanceof(i.ReadStream||s)||e instanceof(i.WriteStream||s))&&a(e.close)}(e)?e.close(s):function(e){return e.setHeader&&a(e.abort)}(e)?e.abort():a(e.destroy)?e.destroy():void u(t||new Error("stream was destroyed"))}},l=function(e){e()},d=function(e,t){return e.pipe(t)};e.exports=function(){var e,t=Array.prototype.slice.call(arguments),r=a(t[t.length-1]||s)&&t.pop()||s;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var n=t.map((function(o,i){var s=i<t.length-1;return u(o,s,i>0,(function(t){e||(e=t),t&&n.forEach(l),s||(n.forEach(l),r(e))}))}));return t.reduce(d)}},279:(e,t,r)=>{"use strict";const n=r(161);e.exports=(e="")=>{const t=e.match(n);if(!t)return null;const[r,o]=t[0].replace(/#! ?/,"").split(" "),i=r.split("/").pop();return"env"===i?o:o?`${i} ${o}`:i}},161:e=>{"use strict";e.exports=/^#!(.*)/},164:(e,t,r)=>{var n=global.process;const o=function(e){return e&&"object"==typeof e&&"function"==typeof e.removeListener&&"function"==typeof e.emit&&"function"==typeof e.reallyExit&&"function"==typeof e.listeners&&"function"==typeof e.kill&&"number"==typeof e.pid&&"function"==typeof e.on};if(o(n)){var i,s=r(491),c=r(475),a=/^win/i.test(n.platform),u=r(361);"function"!=typeof u&&(u=u.EventEmitter),n.__signal_exit_emitter__?i=n.__signal_exit_emitter__:((i=n.__signal_exit_emitter__=new u).count=0,i.emitted={}),i.infinite||(i.setMaxListeners(1/0),i.infinite=!0),e.exports=function(e,t){if(!o(global.process))return function(){};s.equal(typeof e,"function","a callback must be provided for exit handler"),!1===f&&m();var r="exit";return t&&t.alwaysLast&&(r="afterexit"),i.on(r,e),function(){i.removeListener(r,e),0===i.listeners("exit").length&&0===i.listeners("afterexit").length&&l()}};var l=function(){f&&o(global.process)&&(f=!1,c.forEach((function(e){try{n.removeListener(e,p[e])}catch(e){}})),n.emit=x,n.reallyExit=g,i.count-=1)};e.exports.unload=l;var d=function(e,t,r){i.emitted[e]||(i.emitted[e]=!0,i.emit(e,t,r))},p={};c.forEach((function(e){p[e]=function(){o(global.process)&&n.listeners(e).length===i.count&&(l(),d("exit",null,e),d("afterexit",null,e),a&&"SIGHUP"===e&&(e="SIGINT"),n.kill(n.pid,e))}})),e.exports.signals=function(){return c};var f=!1,m=function(){!f&&o(global.process)&&(f=!0,i.count+=1,c=c.filter((function(e){try{return n.on(e,p[e]),!0}catch(e){return!1}})),n.emit=y,n.reallyExit=h)};e.exports.load=m;var g=n.reallyExit,h=function(e){o(global.process)&&(n.exitCode=e||0,d("exit",n.exitCode,null),d("afterexit",n.exitCode,null),g.call(n,n.exitCode))},x=n.emit,y=function(e,t){if("exit"===e&&o(global.process)){void 0!==t&&(n.exitCode=t);var r=x.apply(this,arguments);return d("exit",n.exitCode,null),d("afterexit",n.exitCode,null),r}return x.apply(this,arguments)}}else e.exports=function(){return function(){}}},475:e=>{e.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"],"win32"!==process.platform&&e.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),"linux"===process.platform&&e.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")},709:e=>{"use strict";e.exports=e=>{const t="string"==typeof e?"\n":"\n".charCodeAt(),r="string"==typeof e?"\r":"\r".charCodeAt();return e[e.length-1]===t&&(e=e.slice(0,e.length-1)),e[e.length-1]===r&&(e=e.slice(0,e.length-1)),e}},602:e=>{e.exports=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),o=e[e.length-1];return"function"==typeof n&&n!==o&&Object.keys(o).forEach((function(e){n[e]=o[e]})),n}}},491:e=>{"use strict";e.exports=require("assert")},300:e=>{"use strict";e.exports=require("buffer")},81:e=>{"use strict";e.exports=require("child_process")},361:e=>{"use strict";e.exports=require("events")},147:e=>{"use strict";e.exports=require("fs")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")},781:e=>{"use strict";e.exports=require("stream")},837:e=>{"use strict";e.exports=require("util")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{"use strict";r.r(n),r.d(n,{Runner:()=>c});var e=r(81),t=r(723),o=r.n(t),i=r(17);const s={period:300};class c{constructor(e){this.context=e}log(e){return this.context.logger.log(e)}debug(e){return this.context.logger.debug(e)}error(e){return this.context.logger.error(e)}check(e){if("win32"!==this.context.platform)return this.log("Not running on windows"),!1;if(void 0===global.nestApp)return this.log("Old version, doesn't have netApp"),!1;if(e=e||s,this.log(`Checking if programming or tiggering with trigger ${this.context.trigger}...`),"schedule"===this.context.trigger||this.context.trigger===this.context.scriptName)return this.log("We are triggering"),!0;{this.log(`We are programmging on name ${this.context.scriptName} with schedule: ${e.period} minutes`);const t=global.nestApp.get("SchedulerService").addSchedule("inventory",{interval:60*e.period*1e3,unitName:`${this.context.scriptName}`,immediate:!0});return this.log(`Scheduling result: ${t}`),!1}}async perform(e){try{this.log("Run inventory script...");const e=["-NoProfile","-NoLogo","-NonInteractive","-ExecutionPolicy","Unrestricted","-File",(0,i.join)(__dirname,"Execute.ps1")],t=await o()("C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",e,{reject:!1});return this.log(`Result: ${t.exitCode}`),this.log(`Stdout: ${t.stdout}`),this.log(`Stderr: ${t.stderr}`),!0}catch(e){return this.error(`Error while running inventory script: ${e.stack}`),!1}}async spawn(t,r){this.log(`Spawn inventory script: ${t} ${r.join(" ")}`);const n=(0,e.spawn)(t,r);return new Promise(((e,t)=>{n.once("close",(t=>e(t))),n.once("error",(()=>t()))}))}}})(),n})()));